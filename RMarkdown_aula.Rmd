---
title: "**Resolução dos exercícios**"
author: "Thomaz Rodrigues Lima"
fontsize: 14pt
output: word_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(fpp2)
library(ggplot2)
library(tseries)
load("C:/PENTES/Series_Temporais/aula1.RData")
```

# Questão 1

### a)
```{r}
ggplot(energy) +
  aes(x = as.factor(month), y = energy_demand, fill = as.factor(month)) +
  geom_boxplot(colour = "#112446") +
  xlab("") +
  ylab(iconv("Utilização de Energia", from = "latin1", to = "UTF-8")) +
  theme_minimal()
```
### b) De acordo com o gráfico podemos vizualizar que o maior consumo da-se nos mezes de verão Europeu, com um especial destaque para o mês de julho. Outrem, sendo o mês que menos se consome energia, abril.

### c)

```{r}
class(energy)
```
### d)
```{r}
plot(energy$energy_demand)
```
### e)

```{r}
ts.energy<-ts(energy$energy_demand, frequency = 12, start = c(2012,1))
```

### f)

```{r}
ggplot2::autoplot(ts.energy) +
  ggtitle("Consumo de Energia ao Longo do Tempo") +
  xlab("Tempo") +
  ylab("Consumo de Energia") +
  theme_minimal() +
  theme(
    plot.title = element_text(hjust = 0.5, face = "bold"),
    axis.text = element_text(size = 12),
    axis.title = element_text(size = 14)
  )

```

# Questão 2

### a)
```{r}
ts.gas <-ts(NATURALGAS, frequency = 12, start = c(2000,1))
```
### b)
```{r}
length(gas)
```
### c)
```{r, out.width= "60%",fig.align='center'}
autoplot(ts.gas, size=0.8, col="green")+
  theme_classic()
```
Apresenta Sazonalidade e uma certa tendência Crescente

### d)
```{r}
ggsubseriesplot(ts.gas)
```
### d2)
```{r}
ggseasonplot(ts.gas)
```
Observa-se que de longe o período que mais se usa o gás é em Janeiro, que coincide com inverno no Hemisfério Sul. Já o período que menos se usa é no Verão Europeu

# Questão 3

### a)
```{r}
ts.ph <- ts(ph, frequency = 4, start = c(1988,4))
```
### b)
```{r}
length(ts.ph)
```
### c)
```{r, out.width= "60%",fig.align='center'}
autoplot(ts.ph)+
  ggtitle("ph do Nível do Mar de 1988 até 2020 no Hawaii")
```
Podemos observar que a série temporal apresenta uma tendência decrescente e uma sazonalidade.

###d)
```{r}
ggseasonplot(ts.ph)+
  ggtitle("Sazonalidade do ph da água no Hawaii")
```


# Questão 4
```{r, out.width= "60%",fig.align='center'}
autoplot(dole)+
  ggtitle("Subsídio de desemprego na Austrália")
  xlab("")
```
# Questão 5
```{r, out.width= "60%",fig.align='center'}
autoplot(arrivals, size = 0.8) +
  ggtitle("Chegada nos países")
```
Observa-se que o gráfico tem aumentado em média desde de o primeiro trimestre de 1981.

Enquanto os outros 3 países, o Japão há um aumento até os anos 90 e depois há uma queda.

```{r, out.width= "60%",fig.align='center'}
autoplot(bricksq)+
  ggtitle("Produção de Tijolos na Austrália")
  xlab("")
```

```{r, out.width= "60%",fig.align='center'}
autoplot(lynx)
```

# Questão 6

### b)

```{r}
autoplot(gold)
```
Podemos observar uma tendência crescente até meados do dia 800, após essa data, uma certa tendência decrescente, uma falta de sazonalidade. Um grande Outlayer e alguns dias sem dados

### c)

```{r}
frequency(gold)
```

### d)

```{r}
which.max(gold)
```
### e)

```{r}
anyNA(gold)
```


# Questão 7

```{r, out.width= "60%",fig.align='center'}
autoplot(usdeaths)+
  ggtitle("Mortes Acidentais nos EUA")
```
```{r, out.width= "60%",fig.align='center'}
ggseasonplot(usdeaths)+
  ggtitle("Sazonalidade das Mortes nos EUA na década de 70")
```
```{r, out.width= "60%",fig.align='center'}
ggsubseriesplot(usdeaths)+
  ggtitle("Média de Acidentes por Mês")
```

title: "**Resolução dos exercícios 2**"

# Questão 1

###) a

```{r}
beer.1 <- window(ausbeer, start = 1992)
gglagplot(beer)+theme_bw()
```

```{r}
ggAcf(beer.1)
```
É uma série trimestral, com uma correlação de 4 em 4

```{r}
ggAcf(ts.ph)
```
```{r}
ggAcf(ts.energy, lag.max = 50)
```
Aqui de 12 em 12, que indica que a série é Mensal

```{r}
ggAcf(ts.gas, lag.max = 100)
```
Mais uma vez de 12 em 12, ou seja, mensal

```{r}
ggAcf(gold,lag.max = 200)
```
Claramente a série não tem sazonalidade


# Questão 1

### a)
```{r}
ggAcf(hsales, lag.max = 100)
autoplot(hsales)
```
```{r}
gglagplot(hsales)
```

É um fenômeno ciclico, mas não sazonal

```{r}
ggAcf(usdeaths)
```
Tem sazonalidade, mas não uma tendência muito forte

```{r}
ggAcf(gasoline)
```
```{r}
autoplot(gasoline)
```


Tem uma forte tendência, mas não uma sazonalidade
